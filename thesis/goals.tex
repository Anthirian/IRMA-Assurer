\section{Goals}
\label{sec:goals}
This chapter focuses on the goals of the IRMA Assurer protocol. We will describe the goals that should be met by the protocol and are going to be verified by means of a protocol prover. First and foremost, the protocol should ensure the clients will be authenticated to the server and vice versa. These properties should prevent susceptibility to man-in-the-middle attacks. Furthermore both the all application data sent between client and server should be secret and trustworthy. Also the protocol should be resistant against replay attacks targeting attribute data. Finally the protocol should be designed in such a way that the connection to the server will not cause a denial of service.

To summarize the protocol should offer:
\begin{itemize}
  \item authentication of client to server;
  \item authentication of server to client;
  \item integrity of passport data sent between server and client;
  \item confidentiality of passport data sent between server and client;
  \item integrity of attribute data sent between server, client and card;
  \item confidentiality of attribute data sent between server, client and card;
  \item resistance against replay attacks.
\end{itemize}

In addition, we wish to achieve perfect forward secrecy, meaning an attacker cannot derive previous session keys even if private keys are obtained (see section~\ref{subsubsec:pfs}). This means we have to use cryptographically strong keys, which also should be ephemeral.

Note that replay attacks are partly mitigated by policies surrounding the system. For example, replaying of attribute data is only possible should an attacker have access to the assurer's tablet, which is kept in a safe and is inaccessible. To improve upon this, implementations of the protocol should ensure it does not allow or facilitate storing attribute data internally for repeated use. All attribute data should be stored on the corresponding IRMA card and securely deleted immediately after.

\subsection{Attack scenarios}
This section describes possible attack scenarios with respect to the goals described above. These are attacks the protocol should be resistant against. The possible impact of such an attack is described directly after the attack itself.

\begin{itemize}
	\item An attacker reads the passport data sent between client and server. This attack causes personally identifiable information to be learned, leading to a breach in confidentiality. 
  \item An attacker modifies the passport data sent between client and server. This attack causes the server to receive data inconsistent with the passport data sent by the client, at worst leading to the issuance of attribute data not corresponding to the passport.
  \item An attacker modifies signed attribute data. This attack causes the client to receive incorrect attribute data, at worst leading to the issuance of attribute data not corresponding to the passport.
  \item An attacker intercepts attribute data and stores it onto his own card. This attack causes false issuance of attribute data, in turn leading to possible fraud.
  \item An attacker submits forged passport data to the server. This attack causes the server to possibly provide attribute data for fictitous people, in turn leading to possible fraud. Because the server verifies all passport data before providing attribute data, it may also be possible to query the server, guessing correct personally identifiyable information.
  \item An attacker intercepts and later reuses attribute data already stored onto a card for storing on another card. This attack causes the attacker to be able to commit fraud.
  \item An attacker replays the sending of passport data to obtain another identical set of attribute data. This attack effectively facilitates the cloning of cards, provided the server does not constrain the number of times attributes are given out.
  \item An attacker uses different attributes from different people to authenticate. This attack allows combining attribute data to achieve the required combination for authentication. 
  \item \textsc{TODO: Side-channel attacks?}
  \item An attacker causes a denial of service on the client. This may cause clients to not receive the requested attribute data, causing them to restart the process. This does not lead to a security risk.
  \item An attacker causes a denial of service on the server. This halts all activity surrounding the issuance of attribute data, but does not lead to a security risk.
  \item An attacker shows up with someone else's passport. \texttt{TODO: Impact?}
  \item An attacker switches out the non-initialized IRMA cards before they reach the assurer's office. \texttt{TODO: Impact?}
\end{itemize}

\subsubsection{Perfect Forward Secrecy}
\label{subsubsec:pfs}
In key exchange protocols there is a property called Perfect Forward Secrecy (PFS) that provides a more secure way of encryption with respect to everyday session encryption, because the key is deleted immediately after use and therefore cannot be stolen in an attempt to decrypt intercepted traffic. More specifically, the exposure of long-term keying material, used in the protocol to negotiate session keys, does not compromise the secrecy of session keys established before the exposure. This property is especially relevant to scenarios in which exchanged session keys require secrecy protection beyond their lifetime, such as in the case of session keys used for data encryption. This means it is relevant in the IRMA Assurer protocol, since a lot of sensitive information is being transfered and therefore needs to be kept secret.

The most common way to achieve PFS in a key-exchange protocol is by using the Diffie-Hellman key agreement with ephemeral exponents to establish the value of a session key, while confining the use of the longterm keys (such as private signature keys) to the purpose of authenticating the exchange (see authentication). One essential element for achieving PFS with the Diffie-Hellman exchange is the use of ephemeral exponents which are erased from memory as soon as the exchange is complete. This should include the erasure of any other information from which the value of these exponents can be derived such as the state of a pseudo-random generator used to compute these exponents~\cite{PFS}.

\subsection{Cryptographic properties}
To summarize the previous sections, the protocol should satisfy the following cryptographic properties.
\begin{itemize}
  \item Authenticity
  \item Accountability
  \item Confidentiality
  \item Integrity
  \item \scriptsize Availability
\end{itemize}

