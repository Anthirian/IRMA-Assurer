\subsection{Assumptions}
\label{sec:assumptions}
\subsubsection{Operational}
\begin{itemize}
  \item Het systeem bestaat uit één server en meerdere tablets in een ster-structuur. De tablets communiceren niet onderling, maar enkel met de server.
  \item Tablets worden verspreid over het land met daarop een app die met NFC paspoorten en IRMA kaarten uitleest.
  \item \textbf{Communicatie tussen kaart of paspoort en chiplezer verloopt nog onversleuteld.}
  \item De tablets sturen paspoortdata naar de server ter controle
  \item De server controleert de juistheid van de paspoortdata (buiten scope?) en genereert bijpassende attributen. 
  \item De attributen worden met de enige key ondertekend, zodat iedereen ze kan controleren op echtheid.
  \item De attributen worden door de tablet op de IRMA kaart geplaatst
  \item De attributen worden na plaatsing op de IRMA kaart automatisch verwijderd van de tablets.
  \item De paspoortgegevens worden na omzetting in attributen automatisch door de server verwijderd.
  \item De paspoortgegevens worden na plaatsing van de attributen automatisch verwijderd van de tablets.
\end{itemize}

\subsubsection{Cryptographic}
\begin{itemize}
  \item We maken gebruik van TLS 1.2 vanwege zijn mogelijkheden tot ``Perfect Forward Secrecy''
  \item Perfect Forward Secrecy kan met TLS worden bereikt wanneer je kiest voor Diffie-Hellman (DHE-RSA of DHE-DSS) of Diffie-Hellman met Elliptic Curves (ECDHE-RSA of ECDHE-ECDSA).
  \item ``In principle, any public key encryption scheme can be used to build a key exchange with PFS by using the encryption scheme with ephemeral public and private keys.''~\cite{PFS}
  \item We maken gebruik van Elliptic Curve Diffie-Hellman om PFS te bereiken, ik neig naar ECDHE-RSA vanwege het feit dat RSA efficiënter schijnt te zijn qua crypto.
  \item ``From a practical point of view this requires that the key generation for the encryption scheme be fast enough. For most applications this disqualifies, for example, the use of ephemeral RSA public key encryption for achieving PFS, since the latter requires the generation of two long prime numbers for each exchange, a relatively costly operation.''~\cite{PFS}
  \item De sleutels zijn tenminste 2048 bits. Sleutels van 1024 zijn met veel moeite te kraken, zie Pocket voor artikel op Tweakers.
  \item We laten de server een certificaat maken voor de authenticiteit van de tablet, die wordt geïnstalleerd op de tablet zodra hij wordt geprepareerd. Bijkomend voordeel is dat een tablet onbruikbaar gemaakt kan worden via Certificate Revocation Lists. Hiermee bereiken we authenticatie van tablet aan server.
  \item We installeren `de' (?) public key van de server op de tablets bij preparatie. Tablets sturen een challenge versleuteld met deze key naar de server. De server geeft het juiste antwoord op de challenge en is op die manier geauthenticeerd aan de tablet.
  \item \textsc{Gebruiken we hetzelfde certificaat voor de TLS handshake als voor authenticatie aan de server?}
  \item \textsc{Als de tablet ook de gesignde attributen moet controleren is er hiervoor een key nodig op de tablet}
  \item TLS session resuming is niet toegestaan. Sessienummers in packets worden genegeerd. Reden hiervoor is dat het PFS verzwakt: \url{https://timtaubert.de/blog/2014/11/the-sad-state-of-server-side-tls-session-resumption-implementations/  }
  \item The IRMA Assurer protocol makes use of TCP for its transport layer protocol. The main reason for this is that we require the packets to be delivered without packet loss. In other words, we favor TCP over UDP for its high reliability. Other arguments for choosing TCP include its data flow control and packet reordering capabilities.
  \item Uit de certificaten kan geen sleutel worden afgeleid of afgelezen (volgens mij alleen mogelijk bij gebruik van RSA en fixed DH).
  \item Hergebruiken van DH parameters ter versnelling van de handshake? ``provided that some `DH parameters', i.e. the group into which DH is computed, are reused, which does not entail extra risks, as far as we know''\footnote{\url{http://security.stackexchange.com/questions/35471/is-there-any-particular-reason-to-use-diffie-hellman-over-rsa-for-key-exchange}}
  \item Gebruiken we voor de HMAC MD5, SHA1 of nog beter? \url{https://en.wikipedia.org/wiki/Hash-based_message_authentication_code#Security} Ik neig zelf naar SHA-1 omdat dat niet zoveel rekenwerk kost, maar wel veilig genoeg is. SHA-1 op zichzelf is niet meer veilig, maar binnen HMAC gaat die vlieger niet op.
\end{itemize}

\subsubsection{Key management}
Het gebruik van TLS 1.2 betekent dat beide partijen na de TLS handshake beschikken over een sessiesleutel. Het is hierdoor niet nodig om een extra keypair te hebben voor encryptie. We gebruiken ephemeral keys in combinatie met elliptic curve Diffie-Hellman. Tot slot kiezen we voor RSA in plaats van DSA, met name vanwege efficiëntieredenen. Cryptografisch zijn beide algoritmes even sterk. 

De cipher suites die we gebruiken zijn:

\paragraph{Block ciphers}
\begin{itemize}
	\item AES GCM
  \item AES CCM
  \item AES CBC
  \item Camellia GCM
  \item Camellia CBC
  \item ARIA GCM
  \item ARIA CBC
  \item SEED CBC
  \item GOST 28147-89 CNT
\end{itemize}

\paragraph{Stream ciphers}
\begin{itemize}
	\item ChaCha20-Poly1305 (nog niet vastgelegd in een RFC, wel voorgesteld)
\end{itemize}

Al deze cipher suites zijn veilig tegen publiek bekende (haalbare) aanvallen.


\paragraph{Server}
\begin{itemize}
	\item Heeft (enige) sleutel voor ondertekenen van attributen
  \item Heeft certificaat voor TLS.
  \item Heeft signing keypair voor controle van certificaat op de tablet
  \item Heeft public key van elke client
\end{itemize}

\paragraph{Client}
\begin{itemize}
	\item Heeft signing keypair (met name voor TLS)
  \item Heeft public key van de server
  \item Heeft certificaat, ondertekend door server bij uitgifte tablet
  \item Heeft tweede certificaat voor TLS.
  \item Verschil is dat eerste certificaat door de server is ondertekend en de tweede niet.
  \item Als de server tweede certificaat ook ondertekend had heb je geen goede controle op certificaten voor TLS.
\end{itemize}

\subsubsection{Aandachtspunten}
\begin{itemize}
  \item 
\end{itemize}


